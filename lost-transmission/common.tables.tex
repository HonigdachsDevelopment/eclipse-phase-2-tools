
% TABLES
\newsavebox{\tablebox}
\preto\tabu{\setcounter{magicrownumbers}{0}}
\newcounter{magicrownumbers}
\newcommand\rownumber{\stepcounter{magicrownumbers}\arabic{magicrownumbers}}

% Base fancy Eclipse Phase box
% https://tex.stackexchange.com/questions/78692/using-an-environ-environment-with-newenvironment
\environbodyname\rndtablebody
\NewEnviron{rndtable}[1]{%

    % Alternating background rows
    \taburowcolors[2]{tablecolor!10 .. tablecolor!30}%
    % \addtolength{\extrarowheight}{0.3ex}%
    % \addtolength{\extrarowdepth}{0.3ex}%

    % Actual table content
    % WTF DO I NEED '%' at the end of these lines since otherwise it will look ugly?
    \savebox{\tablebox}{%
        \begin{tabu}[htbp]{#1}%
            \rndtablebody%
        \end{tabu}%
    }%

    % Fancy frame
    \begin{tikzpicture}
        \begin{scope}
          \clip[rounded corners=1ex] (0,-\dp\tablebox) -- (\wd\tablebox,-\dp\tablebox) -- (\wd\tablebox,\ht\tablebox) -- (0,\ht\tablebox) -- cycle;
          \node at (0,-\dp\tablebox) [anchor=south west,inner sep=0pt]{\usebox{\tablebox}};
        \end{scope}
        \draw[rounded corners=1ex] (0,-\dp\tablebox) -- (\wd\tablebox,-\dp\tablebox) -- (\wd\tablebox,\ht\tablebox) -- (0,\ht\tablebox) -- cycle;
    \end{tikzpicture}

}


% Table with one column
\environbodyname\tableonebody
\NewEnviron{tableone}[1]{
    \begin{rndtable}{ X }
        \multicolumn{1}{c}{
            \cellcolor{tablecolor}\color{white} \Large{#1}
    } \\
    \hline
    \tableonebody
    \end{rndtable}
}


% Table with two columns, one of which is row number
\environbodyname\tabletworndbody
\NewEnviron{tabletwornd}[1]{
    \begin{rndtable}{ l | X }
        \multicolumn{2}{c}{
            \cellcolor{tablecolor}\color{white} \Large{#1}
    } \\
    \hline
    \tabletworndbody
    \end{rndtable}
}


% Table with two columns
\environbodyname\tabletwobody
\NewEnviron{tabletwo}[1]{
    %\begin{rndtable}{p{0.25\columnwidth} | p{0.7\columnwidth} }
    \begin{rndtable}{ l | X }
        \multicolumn{2}{c}{
            \cellcolor{tablecolor}\color{white} \Large{#1}
    } \\
    \hline
    \tabletwobody
    \end{rndtable}
}
